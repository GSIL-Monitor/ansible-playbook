---
# tasks file for docker

- name: uninstall old version
  yum: 
    name: {{ item }}
    state: absent
  with_items:
    - docker
    - docker-client
    - docker-client-latest
    - docker-common
    - docker-latest
    - docker-latest-logrotate
    - docker-logrotate
    - docker-selinux
    - docker-engine-selinux
    - docker-engine

- name: add docker repo
  copy:
    src: "docker-ce.repo"
    dest: "/etc/yum.repos.d/docker-ce.repo"

- name: install docker-ce
  yum: 
    name: {{ item }}
    state: present
  with_items:
    - yum-utils
    # - device-mapper-persistent-data
    # - lvm2
    - docker-ce

- name: start docker service
  service:
    name: docker
    state: started
    enable: true

- name: install docker-compose
  get_url:       
    url: {{ BIN_DOCKER_COMPOSE.url }}
    dest: {{ BIN_DOCKER_COMPOSE.dest }}
    mode: {{ BIN_DOCKER_COMPOSE.mode }}

- name: install docker-machine
  get_url: 
    url: {{ BIN_DOCKER_MACHINE.url }}
    dest: {{ BIN_DOCKER_MACHINE.dest }}
    mode: {{ BIN_DOCKER_MACHINE.mode }}









